# [DEV-LOG] 작업 일자: 2026-01-01
**작성자:** Logic Designer (부사수)
**관련 모듈:** core/validator.py, core/analyzer.py

---

## 1. 작업 개요
* **작업 명칭:** 리뷰 신뢰도 판별 로직 및 AI 분석 엔진 기초 설계
* **진행 상태:** 진행 중 (In-Progress)
* **기획 참조:** SPEC.md [M-2], [M-3] 구간 반영

## 2. 상세 설계 내용
| 항목 | 설계 내용 및 로직 | 비고 |
| :--- | :--- | :--- |
| 신뢰도 공식 | S = (L*0.2) + (R*0.2) + (M*0.3) + (P*0.1) + (C*0.2) | 가중치 합산 방식 |
| 광고 판별 | 13단계 체크리스트 기반 키워드 및 패턴 매칭 | 항목당 -10점 감점 |
| AI 페르소나 | 15년 경력 임상 약사 (객관적, 보수적 톤앤매너) | OpenAI GPT-4o 활용 |
| 데이터 구조 | JSON 규격 (Summary, Efficacy, Side_effects, Tip) | UI 연동 표준화 |

## 3. 기술적 특이사항
* **정규표현식 활용:** 대가성 문구 및 홍보성 어미(~했답니다 등) 탐지를 위한 정규식 패턴 구축.
* **예외 처리:** 리뷰 텍스트가 10자 미만인 경우 분석 대상에서 제외하는 프리-필터링 로직 추가.
* **보안:** API Key 유출 방지를 위한 .env 파일 로드 방식 적용.

## 4. 향후 과제
* 수집된 실데이터를 통한 광고 판별 임계값(Threshold) 조정.
* LLM 분석 결과의 할루시네이션(환각) 방지 프롬프트 고도화.

---

# [DEV-LOG] 작업 일자: 2026-01-02
**작성자:** Logic Designer (부사수)
**관련 모듈:** logic_designer/__init__.py, logic_designer/trust_score.py

---

## 1. 작업 개요
* **작업 명칭:** 리뷰 데이터 부족 상황 대응 방안 설계
* **진행 상태:** 설계 완료 (Design Complete)
* **기획 참조:** 예외 처리 시나리오 분석

## 2. 문제 정의
리뷰 평가 시스템에서 다음과 같은 데이터 부족 상황이 발생할 수 있음:
1. 리뷰 텍스트가 비어있는 경우
2. 메타데이터(점수)가 전혀 없는 경우
3. 리뷰 텍스트와 메타데이터가 모두 없는 경우

## 3. 시나리오별 대응 방안

### 3.1 시나리오 1: 리뷰 텍스트가 비어있는 경우

#### 대안 1-1: 조기 종료 (Early Exit)
* **개념:** 리뷰 텍스트가 없으면 즉시 종료하고 오류 반환
* **장점:** 명확한 오류 처리, 불필요한 연산 방지
* **단점:** 메타데이터가 있어도 활용 불가
* **적용 시점:** 텍스트가 필수인 경우

#### 대안 1-2: 메타데이터만으로 평가 (Metadata-Only Scoring) ⭐ 권장
* **개념:** 텍스트가 없어도 메타데이터만으로 기본 점수 계산
* **장점:** 메타데이터 활용 가능, 부분 평가 가능
* **단점:** 광고 패턴 검사 불가, AI 분석 불가
* **적용 시점:** 메타데이터가 충분한 경우

#### 대안 1-3: 기본값 할당 후 경고 (Default Assignment with Warning)
* **개념:** 빈 텍스트에 기본 메시지 할당 후 정상 플로우 진행
* **장점:** 기존 플로우 재사용, 일관된 처리
* **단점:** 인위적 데이터 생성, 의미 있는 분석 어려움

### 3.2 시나리오 2: 메타데이터(점수)가 전혀 없는 경우

#### 대안 2-1: 기본값 사용 (Default Values)
* **개념:** 모든 점수가 없으면 중립적인 기본값(50점) 적용
* **장점:** 구현 단순, 중립적 평가
* **단점:** 실제 데이터 반영 어려움, 신뢰도 하락

#### 대안 2-2: 텍스트 기반 추정 (Text-Based Estimation) ⭐ 권장
* **개념:** 리뷰 텍스트로부터 메타데이터 추정
  - 리뷰 길이 → length_score 추정
  - "재구매", "다시" 키워드 → repurchase_score 추정
  - "한달", "1개월" 키워드 → monthly_use_score 추정
* **장점:** 텍스트 정보 활용, 개인화된 평가, 신뢰도 향상
* **단점:** 추정 오류 가능, 복잡도 증가
* **적용 시점:** 텍스트가 충분한 경우

#### 대안 2-3: 최소 신뢰도 할당 (Minimum Trust Assignment)
* **개념:** 메타데이터 없으면 최소 신뢰도 점수(20점) 할당 및 추가 감점
* **장점:** 보수적 평가, 데이터 부족에 대한 명확한 페널티
* **단점:** 과도한 감점 가능, 사용자 경험 저하

### 3.3 시나리오 3: 리뷰 텍스트와 메타데이터가 모두 없는 경우

#### 대안 3-1: 완전 거부 (Complete Rejection)
* **개념:** 데이터가 전혀 없으면 완전 거부
* **장점:** 명확한 거부, 리소스 절약, 데이터 품질 보장
* **단점:** 사용자 경험 저하, 평가 불가

#### 대안 3-2: 부분 평가 모드 (Partial Evaluation Mode) ⭐ 권장
* **개념:** 일부 데이터만으로도 가능한 평가 수행
  - 텍스트만 있으면 → 텍스트 기반 추정
  - 메타데이터만 있으면 → 메타데이터만 평가
  - 둘 다 없으면 → 최소 평가
* **장점:** 유연한 처리, 부분 평가 가능, 사용자 경험 개선
* **단점:** 복잡도 증가, 일관성 관리 어려움

#### 대안 3-3: 대체 데이터 소스 활용 (Alternative Data Source)
* **개념:** 외부 데이터나 사용자 프로필로 대체
* **장점:** 개인화된 평가, 외부 데이터 활용
* **단점:** 외부 의존성, 구현 복잡, 프라이버시 고려 필요

## 4. 권장 조합 (균형 접근)

| 시나리오 | 선택 대안 | 이유 |
|---------|---------|------|
| 시나리오 1 | 대안 1-2 (메타데이터만 평가) | 메타데이터 활용 가능, 부분 평가 가능 |
| 시나리오 2 | 대안 2-2 (텍스트 기반 추정) | 텍스트 정보 활용, 개인화된 평가 |
| 시나리오 3 | 대안 3-2 (부분 평가 모드) | 유연한 처리, 사용자 경험 개선 |

## 5. 기술적 특이사항
* **조건부 평가 로직:** 데이터 유무에 따라 다른 평가 경로 선택
* **경고 플래그 시스템:** 데이터 부족 상황을 명확히 표시
* **하이브리드 접근:** 여러 대안을 조합하여 최적의 평가 수행

## 6. 구현 계획
* **우선순위 P0:**
  - 시나리오 1: 대안 1-2 구현 (예상 작업량: 2일)
  - 시나리오 2: 대안 2-2 구현 (예상 작업량: 3일)
* **우선순위 P1:**
  - 시나리오 3: 대안 3-2 구현 (예상 작업량: 2일)
* **우선순위 P2:**
  - 폴백 로직 구현 (대안 1-1, 2-1)

## 7. 향후 과제
* 사용자 프로필 데이터 연동 (대안 3-3)
* 텍스트 추정 알고리즘 고도화 (대안 2-2)
* A/B 테스트를 통한 최적 조합 검증
* 데이터 부족 상황 모니터링 대시보드 구축

---

# [DEV-LOG] 작업 일자: 2026-01-05
**작성자:** Logic Designer (부사수)
**관련 모듈:** Git 설정, GitHub 저장소

---

## 1. 작업 개요
* **작업 명칭:** GitHub 한글 인코딩 문제 해결
* **진행 상태:** 완료 (Completed)
* **이슈:** 커밋 메시지 한글 깨짐 현상

## 2. 문제 발견
* **증상:** GitHub 커밋 메시지에서 한글이 깨져 표시됨
  - 깨진 메시지: `寃利?濡쒖쭅, ?좊ː???먯닔 怨꾩궛, AI 遺꾩꽍 ?붿쭊`
  - 원래 메시지: `검증 로직, 신뢰도 점수 계산, AI 분석 엔진`
* **영향 범위:** 커밋 메시지만 깨짐, 파일 내용은 정상

## 3. 원인 분석
* Git 인코딩 설정 미지정 (`i18n.commitencoding` 없음)
* PowerShell에서 한글 입력 시 인코딩 변환 오류
* Git 로그 출력 인코딩 미설정

## 4. 해결 방법
* **Git 전역 인코딩 설정:**
  ```bash
  git config --global i18n.commitencoding utf-8
  git config --global i18n.logoutputencoding utf-8
  git config --global core.quotepath false
  git config --global gui.encoding utf-8
  ```
* **커밋 메시지 수정:**
  - 파일을 통한 커밋 메시지 작성 (`-F` 옵션 사용)
  - `git commit --amend`로 메시지 수정
  - `git push --force`로 GitHub에 반영

## 5. 결과
* ✅ 커밋 메시지가 정상적으로 표시됨
* ✅ GitHub 웹 인터페이스에서도 정상 표시
* ✅ Git 로그에서 한글이 정상적으로 출력됨

## 6. 향후 예방 방안
* 모든 팀원에게 Git 인코딩 설정 공유
* 프로젝트 README에 인코딩 설정 가이드 추가
* `.gitattributes` 파일 추가 고려
* 커밋 메시지 작성 시 파일 사용 권장

## 7. 참고 문서
* 상세 보고서: `logs/github_encoding_fix_report.md`
* 최종 해결 보고서: `logs/github_encoding_fix_final_report.md`

## 8. 최종 결과
* ✅ GitHub 파일 트리 뷰에서 한글 깨짐 문제 완전 해결
* ✅ 모든 관련 커밋 메시지 정상화 완료
* ✅ 커밋 해시: `90296e1` - "Add logic_designer module: 검증 로직, 신뢰도 점수 계산, AI 분석 엔진"

---

# [DEV-LOG] 작업 일자: 2026-01-05
**작성자:** Logic Designer (부사수)
**관련 모듈:** database/, Supabase 연동

---

## 1. 작업 개요
* **작업 명칭:** Supabase 데이터베이스와 GitHub 저장소 연동
* **진행 상태:** 완료 (Completed)
* **목적:** 프로젝트에 Supabase 데이터베이스 연동 기능 추가

## 2. 작업 내용
* **Supabase 클라이언트 모듈 생성**
  - `database/supabase_client.py`: Supabase 클라이언트 싱글톤 패턴 구현
  - `database/__init__.py`: 모듈 초기화 및 export
  - `database/test_connection.py`: 연결 테스트 스크립트

* **환경 변수 설정**
  - `.env` 파일 템플릿 가이드 작성
  - Supabase URL 및 API 키 설정 방법 문서화

* **의존성 추가**
  - `requirements.txt`에 `supabase>=2.0.0` 추가
  - `python-dotenv` 패키지 확인

* **문서 작성**
  - `docs/SUPABASE_SETUP.md`: Supabase 연동 상세 가이드
  - `README.md`: Supabase 설정 섹션 추가

## 3. Supabase 프로젝트 정보
* **프로젝트 URL**: `https://bvowxbpqtfpkkxkzsumf.supabase.co`
* **GitHub 저장소**: `https://github.com/tturupapa-stack/dev2`
* **API 키 타입**:
  - ANON_KEY: 클라이언트 사이드용 (RLS 적용)
  - SERVICE_ROLE_KEY: 서버 사이드용 (관리자 권한)

## 4. 구현 세부사항
* **싱글톤 패턴**: Supabase 클라이언트 인스턴스를 재사용하여 효율성 향상
* **환경 변수 검증**: 필수 환경 변수 누락 시 명확한 에러 메시지 제공
* **연결 테스트 함수**: 데이터베이스 연결 상태를 쉽게 확인 가능

## 5. 보안 조치
* `.gitignore`에 `.env` 파일 추가 확인
* 환경 변수 템플릿만 제공 (실제 키는 커밋하지 않음)
* 서비스 역할 키 사용 시 주의사항 문서화

## 6. 사용 방법
```python
from database import get_supabase_client, test_connection

# 연결 테스트
if test_connection():
    supabase = get_supabase_client()
    # 데이터베이스 작업 수행
```

## 7. 향후 과제
* 리뷰 검증 결과 저장 테이블 스키마 설계
* 리뷰 AI 분석 결과 저장 테이블 스키마 설계
* 데이터베이스 마이그레이션 스크립트 작성
* Supabase RLS 정책 설정

## 8. 참고 문서
* Supabase 연동 가이드: `docs/SUPABASE_SETUP.md`
* Supabase 공식 문서: https://supabase.com/docs